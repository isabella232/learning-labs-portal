# This repository is for Workshop Portal service.

## Build Docker Image

```bash
make
```

Running the `make` command will generate a Docker image for Workshop Portal.
The generated image will have the following image name and tag.

## Push Docker Image to Staging Docker Registry

```bash
make publish
```

## Run Workshop Portal in a Docker Container.

```bash
make run
```

`make run` will build a new docker image before creating a Docker container.

## Run Workshop Portal in a Docker Container with HTTPS enabled

```bash
make run-ssl
```

Similar to `make run`, `make run-ssl` will build a new docker image before 
creating a Docker container.

In this repository, a test SSL certificate is included under `test_cert`.

## Supported Environment Variables

### Variables for Both Build-Time and Run-time

- `IMAGE`: Overrides docker image to be generated by `make build` command. Also,
`make push` and `make run` uses this variable to supply the Docker image
parameter. The default value is `localhost/doc-hub/service-all:local`.

### Build-time Variables

- `BASE_IMAGE`: Overrides the base Docker image. The default value is `node:10`.
- `EXTRA_FILES`: Overrides the path where `/app/files` are sourced.
Configuration files and SSL certificates are typically stored in this directory.
The default value is `files`.

### Run-time Variables

- `DEPLOYMENT_ENV`: The value in this variable will be used when loading a
configuration file. The default value is `local` and the configuration file at
`/app/files/configs/$DEPLOYMENT_ENV.yml` will be loaded when the Workshop Portal
is starting up.
- `RESTART_DOCS`: Restarts all registered workshops when the Workshop Portal 
service is starting up. The default value is `no`.
- `HEC_HOST`: Sets Splunk HEC endpoint.
- `HEC_SOURCE`: Sets Splunk event source type
- `HEC_INDEX`: Sets Splunk event index.
- `HEC_TOKEN`: Sets Splunk HEC token.